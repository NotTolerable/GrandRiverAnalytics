{% extends "base.html" %}
{% block body_class %}admin-shell{% endblock %}
{% block content %}
<section class="admin-hero">
    <div class="container">
        <div class="admin-hero__inner">
            <div>
                <p class="eyebrow">Grand River Analytics</p>
                <h1>Research control center</h1>
                <p class="muted">Monitor publishing status, spotlight featured work, and jump straight into editing.</p>
            </div>
            <a class="button primary" href="{{ url_for('admin_new') }}">Create new report</a>
        </div>
        <dl class="admin-metrics">
            <div>
                <dt>Published</dt>
                <dd>{{ stats.published }}</dd>
            </div>
            <div>
                <dt>Drafts</dt>
                <dd>{{ stats.draft }}</dd>
            </div>
            <div>
                <dt>Featured</dt>
                <dd>{{ stats.featured }}</dd>
            </div>
        </dl>
    </div>
</section>
<section class="section">
    <div class="container">
        <div class="admin-panel">
            <div class="panel-header">
                <h2>Report catalogue</h2>
                <p class="muted">Sorted by most recently updated.</p>
            </div>
            <div class="table-scroll">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Status</th>
                            <th>Featured</th>
                            <th>Updated</th>
                            <th class="actions">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for post in posts %}
                        <tr>
                            <td>
                                <strong>{{ post.title }}</strong>
                                <div class="muted small">/{{ post.slug }}</div>
                            </td>
                            <td>
                                {% if post.published %}<span class="status status-live">Published</span>{% else %}<span class="status status-draft">Draft</span>{% endif %}
                            </td>
                            <td>
                                {% if post.featured %}<span class="status status-featured">Featured</span>{% else %}<span class="status">No</span>{% endif %}
                            </td>
                            <td>{{ post.updated_at|format_date }}</td>
                            <td class="actions">
                                <div class="action-grid">
                                    {% if post.published %}
                                    <a href="{{ url_for('post_detail', slug=post.slug) }}" target="_blank" rel="noopener">View</a>
                                    {% endif %}
                                    <a href="{{ url_for('admin_preview', post_id=post.id) }}" target="_blank" rel="noopener">Preview</a>
                                    <a href="{{ url_for('admin_edit', post_id=post.id) }}">Edit</a>
                                    <form method="post" action="{{ url_for('admin_duplicate', post_id=post.id) }}">
                                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                                        <button type="submit">Duplicate</button>
                                    </form>
                                    <form method="post" action="{{ url_for('admin_delete', post_id=post.id) }}" onsubmit="return confirm('Delete this post?');">
                                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                                        <button type="submit" class="danger">Delete</button>
                                    </form>
                                </div>
                            </td>
                        </tr>
                        {% else %}
                        <tr><td colspan="5" class="muted">No posts found.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>
{% endblock %}
